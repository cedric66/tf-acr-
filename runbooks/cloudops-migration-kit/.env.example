# Cloud Ops AKS Spot Migration Kit - Configuration
# Copy this file to .env and customize for your cluster
# Load with: source .env OR export $(cat .env | xargs)
# See README.md for detailed setup instructions

# ============================================================================
# Cluster Identity (REQUIRED - must match your existing AKS cluster)
# ============================================================================
CLUSTER_NAME=aks-spot-prod
RESOURCE_GROUP=rg-aks-spot
LOCATION=australiaeast
# SUBSCRIPTION_ID=                  # Optional: defaults to current az account

# ============================================================================
# Spot Pool Names (comma-separated, max 12 chars each, lowercase alphanumeric)
# ============================================================================
# SPOT_POOLS=spotgeneral1,spotmemory1,spotgeneral2,spotcompute,spotmemory2

# ============================================================================
# Standard Pool (on-demand fallback - must already exist in cluster)
# ============================================================================
# STANDARD_POOL=stdworkload

# ============================================================================
# System Pool (must already exist in cluster)
# ============================================================================
# SYSTEM_POOL=system

# ============================================================================
# VM SKU per Spot Pool (must match available SKUs in your region)
# ============================================================================
# POOL_VM_SIZE_spotgeneral1=Standard_D4s_v5      # 4 vCPU, 16 GB  - general purpose
# POOL_VM_SIZE_spotmemory1=Standard_E4s_v5       # 4 vCPU, 32 GB  - memory optimized
# POOL_VM_SIZE_spotgeneral2=Standard_D8s_v5      # 8 vCPU, 32 GB  - larger general
# POOL_VM_SIZE_spotcompute=Standard_F8s_v2       # 8 vCPU, 16 GB  - compute optimized
# POOL_VM_SIZE_spotmemory2=Standard_E8s_v5       # 8 vCPU, 64 GB  - large memory

# ============================================================================
# Availability Zones per Spot Pool (comma-separated zone numbers)
# Each spot pool is pinned to ONE zone for blast-radius isolation
# ============================================================================
# POOL_ZONES_spotgeneral1=1
# POOL_ZONES_spotmemory1=2
# POOL_ZONES_spotgeneral2=2
# POOL_ZONES_spotcompute=3
# POOL_ZONES_spotmemory2=3

# ============================================================================
# VM Family per Spot Pool (used for node labels)
# ============================================================================
# POOL_VM_FAMILY_spotgeneral1=general
# POOL_VM_FAMILY_spotmemory1=memory
# POOL_VM_FAMILY_spotgeneral2=general
# POOL_VM_FAMILY_spotcompute=compute
# POOL_VM_FAMILY_spotmemory2=memory

# ============================================================================
# Min/Max Node Counts per Pool (autoscaler range)
# Spot pools default to min=0 (scale-to-zero) for cost savings
# ============================================================================
# POOL_MIN_spotgeneral1=0
# POOL_MAX_spotgeneral1=20
# POOL_MIN_spotmemory1=0
# POOL_MAX_spotmemory1=15
# POOL_MIN_spotgeneral2=0
# POOL_MAX_spotgeneral2=15
# POOL_MIN_spotcompute=0
# POOL_MAX_spotcompute=10
# POOL_MIN_spotmemory2=0
# POOL_MAX_spotmemory2=10

# ============================================================================
# Priority Expander Weights (lower number = higher priority = preferred first)
# Memory-optimized E-series (weight 5) preferred over D/F-series (weight 10)
# ============================================================================
# POOL_PRIORITY_spotmemory1=5
# POOL_PRIORITY_spotmemory2=5
# POOL_PRIORITY_spotgeneral1=10
# POOL_PRIORITY_spotgeneral2=10
# POOL_PRIORITY_spotcompute=10
# POOL_PRIORITY_stdworkload=20
# POOL_PRIORITY_system=30

# ============================================================================
# Spot Pool Defaults (applied to all spot pools unless overridden above)
# ============================================================================
# SPOT_MAX_PRICE=-1               # -1 = up to on-demand price (recommended)
# MAX_PODS=50                     # Max pods per node
# OS_SKU=Ubuntu                   # OS SKU (Ubuntu or AzureLinux)
# OS_DISK_SIZE=128                # OS disk size in GB

# ============================================================================
# Autoscaler Profile (applied via az aks update --auto-scaler-profile)
# Defaults optimized for spot/bursty workloads per Microsoft best practices
# ============================================================================
# AUTOSCALER_EXPANDER=priority
# AUTOSCALER_SCAN_INTERVAL=20s
# AUTOSCALER_SCALE_DOWN_UNREADY=3m
# AUTOSCALER_SCALE_DOWN_UNNEEDED=5m
# AUTOSCALER_SCALE_DOWN_DELAY_AFTER_ADD=10m
# AUTOSCALER_SCALE_DOWN_DELAY_AFTER_DELETE=10s
# AUTOSCALER_SCALE_DOWN_DELAY_AFTER_FAILURE=3m
# AUTOSCALER_SCALE_DOWN_UTILIZATION=0.5
# AUTOSCALER_MAX_GRACEFUL_TERMINATION=60
# AUTOSCALER_MAX_NODE_PROVISIONING_TIME=10m
# AUTOSCALER_MAX_UNREADY_NODES=3
# AUTOSCALER_MAX_UNREADY_PERCENTAGE=45
# AUTOSCALER_NEW_POD_SCALE_UP_DELAY=0s
# AUTOSCALER_BALANCE_SIMILAR=true
# AUTOSCALER_SKIP_LOCAL_STORAGE=false
# AUTOSCALER_SKIP_SYSTEM_PODS=true

# ============================================================================
# Operational Settings
# ============================================================================
# DRY_RUN=false                   # Set to true to print commands without executing
# DRAIN_TIMEOUT=60                # Seconds to wait for node drain during rollback
# LOG_LEVEL=info                  # Logging verbosity (debug, info, warn, error)
